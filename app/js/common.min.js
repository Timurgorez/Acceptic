window.onload = function(){
    

document.forms.reg.onsubmit = function() {
	var name = document.getElementById('name').value;
	var email = document.getElementById('mail').value;
	var password = document.getElementById('password').value;
	//alert(name + email + password);
    //var valid = true;
 	//var regul = /([а-я]+)\s([а-я]+)/i;

 	if(/^[a-zA-Z0-9а-яА-ЯёЁ']{2,15}?$/.test(name)){
 		//alert("Name OK");
 	}else{alert("Вы ввели не правильно имя"); return false;}
 	if(/^[A-z0-9._-]+@[A-z0-9.-]+\.[A-z]{2,4}$/.test(email)){
 		//alert("Mail OK");
 	}else{alert("Вы ввели не правильно почту"); return false;}
 	if(/^[A-z0-9._-]{6,10}?$/.test(password)){
 		//alert("Password OK");
 	}else{alert("Вы ввели не правильно пароль"); return false;}

		var xhr = new XMLHttpRequest();
		var user = 'name=' + name + '&mail=' + email + '&password=' + password;
		xhr.open('POST', 'http://acceptic/app/reg.php', true);
		xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xhr.onreadystatechange = function () {
			if(xhr.status == 200 && xhr.readyState == 4){
				if(~xhr.responseText.indexOf("already exists in the database")){
					alert(xhr.responseText);
				}else{
					// alert("Good job " + xhr.responseText);
					var content = document.getElementById('content');
					content.innerHTML = "<div class='model'>Good job " + xhr.responseText + "</div>";
					document.getElementById("formReg").reset();
				}
			}else{
				// alert(xhr.status);
			}
		}
		xhr.send(user);
		
	
	return false;
  }





document.forms.sign.onsubmit = function() {
    var name = document.getElementById('nameSign').value;
	var password = document.getElementById('passwordSign').value;
	alert(name+ ' ' + password);

	if(/^[a-zA-Z0-9а-яА-ЯёЁ']{2,15}?$/.test(name)){
 		//alert("Name OK");
 	}else{alert("Вы ввели не правильно имя"); return false;}
 	
 	if(/^[A-z0-9._-]{6,10}?$/.test(password)){
 		//alert("Password OK");
 	}else{alert("Вы ввели не правильно пароль"); return false;}

	var xhr = new XMLHttpRequest();
	var user = 'name=' + name + '&password=' + password;
	xhr.open('POST', 'http://acceptic/app/sign.php', true);
	xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
	xhr.onreadystatechange = function () {
		if(xhr.status == 200 && xhr.readyState == 4){
			var content = document.getElementById('contentCh');
			document.getElementById("formSign").reset();
			document.getElementById("change").style.display = "block";
			document.getElementById("mainForms").style.display = "none";
			content.innerHTML = xhr.responseText;

		}else{
			console.log( xhr.status + ': ' + xhr.statusText + "  " + xhr.readyState);
		}
	}
	xhr.send(user);
	return false;
  }



document.forms.change.onsubmit = function() {
	var name = document.getElementById('nameCh').value;
	var email = document.getElementById('mailCh').value;
	var password = document.getElementById('passwordCh').value;
	//alert(name + email + password);
    //var valid = true;
 	//var regul = /([а-я]+)\s([а-я]+)/i;

 	if(/^[a-zA-Z0-9а-яА-ЯёЁ']{2,15}?$/.test(name)){
 		//alert("Name OK");
 	}else{alert("Вы ввели не правильно имя"); return false;}
 	if(/^[A-z0-9._-]+@[A-z0-9.-]+\.[A-z]{2,4}$/.test(email)){
 		//alert("Mail OK");
 	}else{alert("Вы ввели не правильно почту"); return false;}
 	if(/^[A-z0-9._-]{6,10}?$/.test(password)){
 		//alert("Password OK");
 	}else{alert("Вы ввели не правильно пароль"); return false;}

		var xhr = new XMLHttpRequest();
		var user = 'name=' + name + '&mail=' + email + '&password=' + password;
		xhr.open('POST', 'http://acceptic/app/change.php', true);
		xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xhr.onreadystatechange = function () {
			if(xhr.status == 200 && xhr.readyState == 4){
				if(~xhr.responseText.indexOf("already exists in the database")){
					alert(xhr.responseText);
				}else{
					var content = document.getElementById('contentCh');
					alert("all good");
					//content.innerHTML = "<div class='model'>Good job " + xhr.responseText + "</div>";

				}
			}else{
				// alert(xhr.status);
			}
		}
		xhr.send(user);
		
	
	return false;
  }









//$.ajax({
//    	url: '../func.php',
//        type: 'POST',
//        data: {userName:name, mail:email, password:passwordUser},
//        success: function(data){
//			$('#content').html(data);
//		}
//    })

















};